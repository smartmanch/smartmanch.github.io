<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delhi History Quiz - Learning Mode</title>
    <style>
        /* --- General & Typography --- */
        html, body {
            height: 100%; 
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif; 
            background-color: #eef4f8; 
            color: #333;
            line-height: 1.6;
            overflow: hidden; /* Crucial: Hide main body scrollbar */
        }
        .header {
            background-color: #1a73e8; 
            color: white;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .header h1 {
            margin: 0;
            font-size: 1.6em;
            font-weight: 600;
        }
        .container {
            max-width: 1000px;
            margin: 10px auto; 
            padding: 0 10px;
            height: calc(100vh - 70px); 
            display: flex;
            gap: 15px;
            box-sizing: border-box;
        }
        h2 {
            color: #1a73e8;
            font-size: 1.4em;
            margin-bottom: 8px;
            text-align: left;
        }

        /* --- Input Page Styling --- */
        #input-page {
            width: 100%;
            background: white;
            padding: 30px; 
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: block; 
            height: fit-content;
        }
        .input-group { margin: 15px auto; max-width: 400px; text-align: left; }
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        .start-button { background-color: #fbbc05; color: #333; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 1.1em; margin-top: 20px; box-shadow: 0 3px #e0a800; }

        /* --- Quiz Layout (Side-by-Side View) --- */
        #quiz-page {
            display: none;
            width: 100%;
            display: flex;
            gap: 15px;
            height: 100%; 
        }
        
        .passage-area, .question-area {
            flex: 1; 
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            height: 100%; 
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        .passage-area {
            background-color: white;
            overflow-y: auto; /* Allow internal scroll only for the passage content */
        }

        .question-area {
            background-color: #f9f9f9;
            overflow-y: hidden; 
        }
        
        .passage-card { border-left: 6px solid #fbbc05; padding: 10px; background-color: #ffffff; border-radius: 5px; }
        .passage-card p { font-size: 0.9em; margin: 0; } 
        .highlight { background-color: #a8dadc; padding: 1px 3px; border-radius: 4px; font-weight: 600; transition: background-color 0.5s; }

        .score-board { background: #4285f4; color: white; padding: 8px; font-size: 1.1em; border-radius: 8px; margin-bottom: 10px; font-weight: 600; }
        .progress-container { margin-bottom: 10px; font-weight: 500; color: #555; flex-shrink: 0; }
        
        /* Question View Container */
        #questions-container {
            flex-grow: 1;
            position: relative;
            padding: 5px 0;
            overflow-y: auto; /* Allow internal scroll only for the question/options */
        }

        .question {
            padding: 15px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            display: none; 
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            transition: opacity 0.3s;
        }
        .question.active { display: block; }
        .question p strong { font-size: 1em; }

        .options button { width: 100%; padding: 10px; margin: 6px 0; border: 1px solid #b8daff; border-radius: 8px; font-size: 0.9em; }
        .options button:hover:not(:disabled) { background-color: #1a73e8; color: white; }
        .feedback { margin-top: 8px; padding: 8px; font-size: 0.9em; }
        
        .correct { background-color: #34a853 !important; color: white !important; border: 1px solid #34a853 !important; }
        .incorrect { background-color: #ea4335 !important; color: white !important; border: 1px solid #ea4335 !important; }
        .disabled { cursor: not-allowed; opacity: 0.8; }
        .next-button { background-color: #34a853; color: white; padding: 8px 15px; border-radius: 8px; margin-top: 10px; display: none; float: right; font-size: 0.9em; }

        /* --- Result Page Styling --- */
        #result-page {
            display: none;
            width: 100%;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            height: fit-content;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>**‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§∏‡•à‡§®‡•Ä‡§™‡•Å‡§∞‡§æ, ‡§®‡§µ‡§≤‡§ó‡§¢‡§º, ‡§ù‡•Å‡§Ç‡§ù‡•Å‡§®‡•Ç**</h1>
    </div>

    <div class="container">
        
        <div id="input-page">
            <h2>üìù Enter Student Details to Start</h2>
            <div class="input-group">
                <label for="studentName">Name:</label>
                <input type="text" id="studentName" required>
            </div>
            <div class="input-group">
                <label for="rollNumber">Roll Number:</label>
                <input type="text" id="rollNumber" required>
            </div>
            <div class="input-group">
                <label for="className">Class:</label>
                <input type="text" id="className" required>
            </div>
            <button class="start-button" onclick="startQuiz()">Start Quiz</button>
        </div>

        <div id="quiz-page">
            
            <div class="passage-area">
                <h2 style="border-bottom: 2px solid #eef4f8;">üìñ Passage: Walk in Delhi</h2>
                <div class="passage-card">
                    <p id="passageContent">
                        </p>
                </div>
            </div>

            <div class="question-area">
                <div class="score-board">
                    Current Score: <span id="current-score">0</span>
                </div>
                
                <div class="progress-container">
                    Question <span id="currentQuestionNumber">1</span> of 9
                    <div class="progress-bar">
                        <div id="progressBarFill"></div>
                    </div>
                </div>

                <div id="questions-container">
                    
                    <div class="question active" id="q1">
                        <p><strong>i) Where was the writer walking?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(1, 'A', 'A', 'p1')">A) Along the street of Delhi</button>
                            <button onclick="checkAnswer(1, 'B', 'A', 'p1')">B) In Connaught Circus</button>
                            <button onclick="checkAnswer(1, 'C', 'A', 'p1')">C) In the Maurya Empire</button>
                            <button onclick="checkAnswer(1, 'D', 'A', 'p1')">D) In a deserted area</button>
                        </div>
                        <div class="feedback" id="feedback-1"></div>
                        <button class="next-button" onclick="nextQuestion(1)">Next Question</button>
                    </div>

                    <div class="question" id="q2">
                        <p><strong>ii) In which fields had man achieved greatness, according to the writer?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(2, 'A', 'D', 'p2')">A) Astronomy and Algebra</button>
                            <button onclick="checkAnswer(2, 'B', 'D', 'p2')">B) Poetry and Music</button>
                            <button onclick="checkAnswer(2, 'C', 'D', 'p2')">C) Architecture and Art</button>
                            <button onclick="checkAnswer(2, 'D', 'D', 'p2')">D) All of the above</button>
                        </div>
                        <div class="feedback" id="feedback-2"></div>
                        <button class="next-button" onclick="nextQuestion(2)">Next Question</button>
                    </div>
                    
                    <div class="question" id="q3">
                        <p><strong>iii) Where did the writer meet Shovan Lal?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(3, 'A', 'B', 'p4')">A) On the street of Delhi</button>
                            <button onclick="checkAnswer(3, 'B', 'B', 'p4')">B) Connaught Circus</button>
                            <button onclick="checkAnswer(3, 'C', 'B', 'p4')">C) Near Akbar and Ashoka's palace</button>
                            <button onclick="checkAnswer(3, 'D', 'B', 'p4')">D) After walking eight miles</button>
                        </div>
                        <div class="feedback" id="feedback-3"></div>
                        <button class="next-button" onclick="nextQuestion(3)">Next Question</button>
                    </div>
                    
                    <div class="question" id="q4">
                        <p><strong>iv) Who first greeted the writer with ‚ÄúHullo‚Äù?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(4, 'A', 'C', 'p5')">A) An older man</button>
                            <button onclick="checkAnswer(4, 'B', 'C', 'p5')">B) One of the younger men</button>
                            <button onclick="checkAnswer(4, 'C', 'C', 'p5')">C) Shovan Lal</button>
                            <button onclick="checkAnswer(4, 'D', 'C', 'p5')">D) One of his friends</button>
                        </div>
                        <div class="feedback" id="feedback-4"></div>
                        <button class="next-button" onclick="nextQuestion(4)">Next Question</button>
                    </div>

                    <div class="question" id="q5">
                        <p><strong>v) Whose friends are described in the passage?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(5, 'A', 'A', 'p6')">A) Shovan Lal's friends</button>
                            <button onclick="checkAnswer(5, 'B', 'A', 'p6')">B) The writer's friends</button>
                            <button onclick="checkAnswer(5, 'C', 'A', 'p6')">C) Akbar's friends</button>
                            <button onclick="checkAnswer(5, 'D', 'A', 'p6')">D) The group's friends</button>
                        </div>
                        <div class="feedback" id="feedback-5"></div>
                        <button class="next-button" onclick="nextQuestion(5)">Next Question</button>
                    </div>
                    
                    <div class="question" id="q6">
                        <p><strong>vi) Who started speaking very fast in a strange dialect?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(6, 'A', 'B', 'p8')">A) An older man</button>
                            <button onclick="checkAnswer(6, 'B', 'B', 'p8')">B) One of the younger men</button>
                            <button onclick="checkAnswer(6, 'C', 'B', 'p8')">C) Shovan Lal</button>
                            <button onclick="checkAnswer(6, 'D', 'B', 'p8')">D) The writer</button>
                        </div>
                        <div class="feedback" id="feedback-6"></div>
                        <button class="next-button" onclick="nextQuestion(6)">Next Question</button>
                    </div>
                    
                    <div class="question" id="q7">
                        <p><strong>vii) Who translated the strange dialect conversation for the writer?</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(7, 'A', 'D', 'p9')">A) An older man</button>
                            <button onclick="checkAnswer(7, 'B', 'D', 'p9')">B) One of the friends</button>
                            <button onclick="checkAnswer(7, 'C', 'D', 'p9')">C) The writer himself</button>
                            <button onclick="checkAnswer(7, 'D', 'D', 'p9')">D) Shovan Lal</button>
                        </div>
                        <div class="feedback" id="feedback-7"></div>
                        <button class="next-button" onclick="nextQuestion(7)">Next Question</button>
                    </div>
                    
                    <div class="question" id="q8">
                        <p><strong>viii) Write the similar word of the following from the passage: ‚ÄòWishing‚Äô (meaning desiring to know)</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(8, 'A', 'C', 'p1')">A) Replied</button>
                            <button onclick="checkAnswer(8, 'B', 'C', 'p1')">B) Waved</button>
                            <button onclick="checkAnswer(8, 'C', 'C', 'p1')">C) Wondered</button>
                            <button onclick="checkAnswer(8, 'D', 'C', 'p1')">D) Translated</button>
                        </div>
                        <div class="feedback" id="feedback-8"></div>
                        <button class="next-button" onclick="nextQuestion(8)">Next Question</button>
                    </div>

                    <div class="question" id="q9">
                        <p><strong>ix) Write the opposite word of the following from the passage: ‚ÄòStopped‚Äô</strong></p>
                        <div class="options">
                            <button onclick="checkAnswer(9, 'A', 'A', 'p8')">A) Started</button>
                            <button onclick="checkAnswer(9, 'B', 'A', 'p8')">B) Replied</button>
                            <button onclick="checkAnswer(9, 'C', 'A', 'p8')">C) Moved Aside</button>
                            <button onclick="checkAnswer(9, 'D', 'A', 'p8')">D) Joined in</button>
                        </div>
                        <div class="feedback" id="feedback-9"></div>
                        <button class="next-button" onclick="nextQuestion(9)">Finish Quiz</button>
                    </div>

                </div>
            </div>
        </div>

        <div id="result-page">
            <h2 style="color: #34a853;">üéâ Quiz Result</h2>
            <div class="result-details">
                <p><strong>Name:</strong> <span id="res-name"></span></p>
                <p><strong>Roll Number:</strong> <span id="res-roll"></span></p>
                <p><strong>Class:</strong> <span id="res-class"></span></p>
                <hr>
                <h3 style="color: #1a73e8; font-size: 1.5em; text-align: center;">Total Score Achieved:</h3>
                <div class="final-score"><span id="res-score"></span> / 18</div>
                <p style="text-align: center; color: #555;">(Maximum Possible Score: 18)</p>
            </div>
            <div class="wishes">
                **üåü All the best for your future, dear student! Keep learning! üåü**
            </div>
        </div>

    </div>

    <script>
        // Global Variables
        let score = 0;
        const correctPoints = 2;
        const totalQuestions = 9; 
        const questionsAttempted = {}; // 0: First attempt, 1: First try failed (retry allowed), 2: Finalized
        let studentInfo = {}; 
        let currentQNum = 1;

        // --- Passage Mapping (Full Passage with IDs) ---
        const rawPassage = {
            'p1': 'I walked along the street of Delhi. I wondered what the history of my country meant to me.',
            'p2': 'Here was a land where man had achieved greatness on every plane ‚Äì Astronomy, Algebra, Architecture, even Poetry, Music and Art.',
            'p3': 'Yet in this very city, where seven empires had come and gone, where Akbar and Ashoka ruled, I could not get a job and a boy like Shovan Lal had not been able to finish his schooling.',
            'p4': 'By 11 o‚Äôclock, I had walked eight miles. When I met Shovan Lal, Connaught Circus was nearly deserted.',
            'p5': '‚ÄúHullo‚Äù, Shovan Lal said, greeting me in Hindi. ‚ÄúHullo‚Äù I replied as a few men around him moved aside to let me come to him.',
            'p6': '‚ÄúThese are my friends‚Äù, Shovan Lal added waving his hand over the group. ‚ÄúWhat do they have to say about my working with them here in Connaught Circus ?‚Äù',
            'p7': '‚ÄúWell‚Äù, Shovan Lal replied, pulling a face.',
            'p8': 'Just then one of the younger men started speaking very fast in a strange dialect I could not easily follow. This was taken up by an older man and in a few minutes four others joined in.',
            'p9': 'When they stopped talking, Shovan Lal, who had been quiet all this time, translated for me.',
        };

        // --- Initialization and UI Functions ---

        function loadPassage() {
            let passageHtml = '';
            for (const id in rawPassage) {
                passageHtml += `<span id="${id}">${rawPassage[id]}</span> `;
            }
            document.getElementById('passageContent').innerHTML = passageHtml;
        }

        function updateProgressBar() {
            const attemptedCount = currentQNum > totalQuestions ? totalQuestions : currentQNum - 1;
            const percentage = (attemptedCount / totalQuestions) * 100;
            document.getElementById('progressBarFill').style.width = percentage + '%';
        }

        function startQuiz() {
            const name = document.getElementById('studentName').value.trim();
            const roll = document.getElementById('rollNumber').value.trim();
            const className = document.getElementById('className').value.trim();

            if (!name || !roll || !className) {
                alert("Please fill in all details (Name, Roll Number, Class).");
                return;
            }

            studentInfo = { name, roll, className };
            document.getElementById('input-page').style.display = 'none';
            document.getElementById('quiz-page').style.display = 'flex';
            loadPassage(); 
            document.getElementById('q1').classList.add('active'); 
            updateProgressBar(); 
        }

        function showResult() {
            document.getElementById('res-name').textContent = studentInfo.name;
            document.getElementById('res-roll').textContent = studentInfo.roll;
            document.getElementById('res-class').textContent = studentInfo.className;
            document.getElementById('res-score').textContent = score;

            document.getElementById('quiz-page').style.display = 'none';
            document.getElementById('result-page').style.display = 'block';
        }

        // --- Question Navigation ---

        function nextQuestion(qNum) {
            const currentQuestionElement = document.getElementById('q' + qNum);
            const nextQNum = qNum + 1;
            const nextQuestionElement = document.getElementById('q' + nextQNum);

            // Hide current question
            currentQuestionElement.classList.remove('active');
            
            if (nextQuestionElement) {
                // Show next question
                nextQuestionElement.classList.add('active');
                currentQNum = nextQNum;
                document.getElementById('currentQuestionNumber').textContent = currentQNum;
                loadPassage(); // Clear any previous passage highlight
            } else {
                // If no next question, show results
                showResult();
            }
            updateProgressBar();
        }

        // --- Helper/UI Functions ---

        function updateScore(points) {
            score += points;
            document.getElementById('current-score').textContent = score;
        }

        function disableQuestionOptions(qNum, enable) {
            const questionElement = document.getElementById('q' + qNum);
            const options = questionElement.querySelectorAll('.options button');
            options.forEach(button => {
                button.disabled = !enable;
                if(!enable) button.classList.add('disabled');
                else button.classList.remove('disabled');
            });
        }
        
        function getButtonByAnswer(qNum, answerKey) {
            const options = document.getElementById('q' + qNum).querySelectorAll('.options button');
            let targetButton = null;
            options.forEach(button => {
                const buttonText = button.textContent.trim();
                if (buttonText.startsWith(answerKey + ')')) {
                    targetButton = button;
                }
            });
            return targetButton;
        }

        function highlightPassageSource(sourceId, isCorrect) {
            loadPassage(); // Clear any existing highlight first

            if (isCorrect) {
                const highlightedElement = document.getElementById(sourceId);
                if (highlightedElement) {
                    highlightedElement.classList.add('highlight');
                    // Scroll passage area to the highlighted text (internal scroll)
                    const passageArea = document.querySelector('.passage-area');
                    passageArea.scrollTop = highlightedElement.offsetTop - passageArea.offsetTop - 50; 
                }
            }
        }

        function showFeedback(qNum, isCorrect, attemptStatus, message, correctAnsKey) {
            const feedbackElement = document.getElementById('feedback-' + qNum);
            const correctButton = getButtonByAnswer(qNum, correctAnsKey);

            feedbackElement.textContent = '';
            
            // Clear previous highlighting classes from all options
            const options = document.getElementById('q' + qNum).querySelectorAll('.options button');
            options.forEach(button => {
                button.classList.remove('correct', 'incorrect');
            });

            if (isCorrect) {
                // Correct Answer (First or Second Try)
                const points = attemptStatus === 0 ? correctPoints : 0;
                feedbackElement.textContent = `‚úÖ Correct! ${attemptStatus === 0 ? '+' + correctPoints + ' points awarded.' : 'No points awarded (second attempt). You may now proceed.'}`;
                feedbackElement.style.backgroundColor = '#e6ffed';
                feedbackElement.style.color = '#34a853';
                correctButton.classList.add('correct');
                
                // Show Next button and disable options
                document.getElementById('q' + qNum).querySelector('.next-button').style.display = 'block';
                disableQuestionOptions(qNum, false);
            } else {
                // Incorrect Answer
                if (attemptStatus === 0) {
                    // First Fail: Provide hint, ask for retry.
                    feedbackElement.textContent = `‚ùå Incorrect. Check the highlighted area in the passage (source) and try again.`;
                    feedbackElement.style.backgroundColor = '#ffebe6';
                    feedbackElement.style.color = '#ea4335';
                    // Options remain enabled
                } else {
                    // Second Fail (Final): Finalize and move on.
                    feedbackElement.textContent = `‚ùå Incorrect. Attempts exhausted. The correct answer has been marked in green.`;
                    feedbackElement.style.backgroundColor = '#ffebe6';
                    feedbackElement.style.color = '#ea4335';
                    correctButton.classList.add('correct'); // Show the correct answer
                    
                    // Show Next button and disable options
                    document.getElementById('q' + qNum).querySelector('.next-button').style.display = 'block';
                    disableQuestionOptions(qNum, false);
                }
            }
        }
        
        // --- Main Logic ---

        function checkAnswer(qNum, userAnsKey, correctAnsKey, sourceId) {
            if (questionsAttempted[qNum] === undefined) {
                questionsAttempted[qNum] = 0; // 0: First attempt
            }
            if (questionsAttempted[qNum] === 2) return; 

            const isCorrect = (userAnsKey === correctAnsKey);
            const currentAttempt = questionsAttempted[qNum];
            const userButton = getButtonByAnswer(qNum, userAnsKey);

            if (isCorrect) {
                // Correct Answer
                if (currentAttempt === 0) {
                    updateScore(correctPoints); 
                }
                questionsAttempted[qNum] = 2; // Finalize
                highlightPassageSource(sourceId, true); // Highlight source on success
                showFeedback(qNum, true, currentAttempt, '', correctAnsKey);
            } else {
                // Incorrect Answer
                if (currentAttempt === 0) {
                    // First Fail
                    questionsAttempted[qNum] = 1; // Mark for second try
                    userButton.classList.add('incorrect'); // Highlight user's incorrect choice
                    highlightPassageSource(sourceId, true); // Highlight source as hint
                    showFeedback(qNum, false, currentAttempt, '', correctAnsKey);
                } else {
                    // Second Fail (Final)
                    questionsAttempted[qNum] = 2; // Finalize as failed
                    userButton.classList.add('incorrect'); 
                    highlightPassageSource(sourceId, false); // Do NOT highlight on second fail
                    showFeedback(qNum, false, currentAttempt, '', correctAnsKey);
                }
            }
        }

        // Initialize display properties and handlers
        document.addEventListener('DOMContentLoaded', () => {
             // Show input page initially
            document.getElementById('input-page').style.display = 'block';
            document.getElementById('quiz-page').style.display = 'none';
        });
    </script>
</body>
</html>