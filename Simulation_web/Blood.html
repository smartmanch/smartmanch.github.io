<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blood Donation Simulation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        h2 {
            color: #e74c3c;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-align: center;
            margin-bottom: 20px;
        }

        .container {
            width: 800px;
            background: #34495e;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.6);
            padding: 30px;
            border: 2px solid #7f8c8d;
            position: relative;
        }

        /* लेआउट: डोनर -> पाइप -> रिसीवर */
        .lab-setup {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }

        .person-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 200px;
            z-index: 2;
        }

        .label {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ecf0f1;
        }

        /* रक्त की थैली (Donor) */
        .blood-bag {
            width: 80px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px 10px 40px 40px;
            position: relative;
            overflow: hidden;
        }
        
        .blood-content {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 90%;
            background-color: #c0392b;
            transition: height 2s;
        }

        /* मरीज/दिल (Recipient) */
        .heart-shape {
            width: 80px;
            height: 80px;
            background-color: #7f8c8d; /* शुरू में ग्रे */
            display: inline-block;
            margin-top: 20px;
            position: relative;
            transform: rotate(-45deg);
            transition: background-color 1s;
        }
        .heart-shape:before, .heart-shape:after {
            content: "";
            width: 80px;
            height: 80px;
            background-color: inherit; /* पैरेंट का रंग लेगा */
            border-radius: 50%;
            position: absolute;
        }
        .heart-shape:before { top: -40px; left: 0; }
        .heart-shape:after { top: 0; left: 40px; }

        /* नली (Pipe) */
        .tube-container {
            flex-grow: 1;
            height: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin: 0 10px;
            position: relative;
            overflow: hidden;
            border: 1px solid #576574;
        }

        .blood-flow {
            width: 0%;
            height: 100%;
            background-color: #e74c3c;
            border-radius: 10px;
            transition: width 0.1s linear;
            box-shadow: 0 0 10px #c0392b;
        }

        /* कंट्रोल्स */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #7f8c8d;
        }

        select {
            padding: 10px 15px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            background: #ecf0f1;
            color: #2c3e50;
            font-weight: bold;
        }

        button {
            padding: 10px 30px;
            font-size: 18px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 0 #219150;
            transition: transform 0.1s;
        }
        button:active { transform: translateY(4px); box-shadow: none; }
        button:disabled { background-color: #95a5a6; cursor: not-allowed; transform: none; box-shadow: none;}

        /* रिजल्ट बॉक्स */
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .success { color: #2ecc71; font-weight: bold; }
        .error { color: #e74c3c; font-weight: bold; }
        .clot-icon { font-size: 30px; margin-right: 10px; }

        /* Footer */
        .footer-info {
            margin-top: 15px;
            text-align: center;
            font-size: 14px;
            color: #95a5a6;
        }
        .cc-badge { background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; font-weight: bold; margin-right: 5px;}
        .author-name { color: #0be881; font-weight: bold; letter-spacing: 0.5px; }

    </style>
</head>
<body>

    <h2>रक्तदान सिमुलेशन (Blood Donation)</h2>

    <div class="container">
        
        <div class="lab-setup">
            <div class="person-box">
                <div class="label">Donor (दाता)</div>
                <div class="blood-bag">
                    <div id="bagLevel" class="blood-content"></div>
                    <div style="position:absolute; top:40%; width:100%; text-align:center; font-weight:bold; font-size:20px; color:rgba(255,255,255,0.8);" id="donorLabel">O+</div>
                </div>
            </div>

            <div class="tube-container">
                <div id="flowBar" class="blood-flow"></div>
            </div>

            <div class="person-box">
                <div class="label">Recipient (ग्राही)</div>
                <div style="padding: 20px;">
                    <div id="recipientHeart" class="heart-shape"></div>
                </div>
                <div style="margin-top: 10px; font-weight:bold; font-size:20px;" id="recipientLabelDisplay">AB+</div>
            </div>
        </div>

        <div id="resultDisplay" class="result-box">
            सिमुलेशन शुरू करने के लिए ब्लड ग्रुप चुनें और बटन दबाएं।
        </div>

        <div class="controls">
            <div>
                <label>Donor Group: </label>
                <select id="donorSelect" onchange="updateLabels()">
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+" selected>O+</option>
                    <option value="O-">O-</option>
                </select>
            </div>

            <button id="transfuseBtn" onclick="startTransfusion()">Transfuse Blood</button>

            <div>
                <label>Recipient Group: </label>
                <select id="recipientSelect" onchange="updateLabels()">
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+" selected>AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                </select>
            </div>
        </div>

    </div>

    <div class="footer-info">
        <span class="cc-badge">CC</span> <span class="author-name">@Rohitash Bharia</span>
        <p>नोट: O- सार्वभौमिक दाता (Universal Donor) है और AB+ सार्वभौमिक ग्राही (Universal Recipient) है।</p>
    </div>

<script>
    const donorSelect = document.getElementById('donorSelect');
    const recipientSelect = document.getElementById('recipientSelect');
    const flowBar = document.getElementById('flowBar');
    const resultDisplay = document.getElementById('resultDisplay');
    const bagLevel = document.getElementById('bagLevel');
    const recipientHeart = document.getElementById('recipientHeart');
    const btn = document.getElementById('transfuseBtn');

    // लेबल्स अपडेट करें
    function updateLabels() {
        document.getElementById('donorLabel').innerText = donorSelect.value;
        document.getElementById('recipientLabelDisplay').innerText = recipientSelect.value;
        resetSim();
    }

    function resetSim() {
        flowBar.style.width = '0%';
        flowBar.style.backgroundColor = '#e74c3c';
        flowBar.style.transition = 'none';
        
        bagLevel.style.height = '90%'; // फुल बैग
        recipientHeart.style.backgroundColor = '#7f8c8d'; // ग्रे हार्ट (Dead/Waiting)
        
        resultDisplay.innerHTML = "तैयार। बटन दबाएं।";
        resultDisplay.className = "result-box";
        btn.disabled = false;
    }

    // अनुकूलता जांचने का लॉजिक (Compatibility Logic)
    function checkCompatibility(donor, recipient) {
        // Rh Factor Logic: Negative can give to Positive, but Positive CANNOT give to Negative
        const dRh = donor.includes('+') ? '+' : '-';
        const rRh = recipient.includes('+') ? '+' : '-';

        if (dRh === '+' && rRh === '-') {
            return false; // Incompatible Rh
        }

        // Blood Type Logic
        const dType = donor.replace('+', '').replace('-', '');
        const rType = recipient.replace('+', '').replace('-', '');

        if (dType === 'O') return true; // O gives to everyone
        if (rType === 'AB') return true; // AB takes from everyone
        if (dType === rType) return true; // Same type is okay

        // A gives to A, AB (Already covered AB above)
        // B gives to B, AB (Already covered AB above)
        
        return false;
    }

    function startTransfusion() {
        resetSim();
        btn.disabled = true;
        resultDisplay.innerText = "रक्ताधान शुरू हो रहा है...";

        const donor = donorSelect.value;
        const recipient = recipientSelect.value;
        const isCompatible = checkCompatibility(donor, recipient);

        // एनिमेशन शुरू (नली भरना)
        setTimeout(() => {
            flowBar.style.transition = 'width 2s linear';
            
            if (isCompatible) {
                // सफल केस: पूरा बहेगा
                flowBar.style.width = '100%';
                bagLevel.style.height = '10%'; // बैग खाली

                setTimeout(() => {
                    recipientHeart.style.backgroundColor = '#c0392b'; // दिल लाल हो गया (जीवित)
                    resultDisplay.innerHTML = `<span class="success">✅ सफल! ${recipient} ने ${donor} रक्त स्वीकार कर लिया।</span>`;
                    btn.disabled = false;
                }, 2000);

            } else {
                // असफल केस: बीच में रुक जाएगा (क्लॉटिंग)
                flowBar.style.width = '50%'; // आधा बहेगा
                
                setTimeout(() => {
                    // क्लॉटिंग एनिमेशन
                    flowBar.style.transition = 'background-color 0.5s';
                    flowBar.style.backgroundColor = '#2c3e50'; // काला पड़ गया (Clot)
                    recipientHeart.style.backgroundColor = '#2c3e50'; // दिल काला (Reaction)
                    
                    resultDisplay.innerHTML = `<span class="error">❌ खतरा! रक्त का थक्का जम गया (Agglutination)। <br> ${donor} रक्त ${recipient} को नहीं दिया जा सकता।</span>`;
                    btn.disabled = false;
                }, 1000); // 1 सेकंड पर रुक जाएगा
            }
        }, 100);
    }

    // शुरू में लेबल्स सेट करें
    updateLabels();

</script>
</body>
</html>