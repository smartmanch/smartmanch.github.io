<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visible Torch & VIBGYOR - Smart Manch</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #1a1a1a;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 10px;
            user-select: none;
        }
        h2 { color: #f1c40f; margin: 10px 0; font-size: 24px; }
        
        .controls {
            background: #34495e;
            padding: 10px 25px;
            border-radius: 50px;
            display: flex;
            gap: 20px;
            align-items: center;
            border: 1px solid #555;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        canvas {
            border: 2px solid #555;
            border-radius: 8px;
            background-color: #000;
        }

        .instructions {
            margin-top: 10px;
            font-size: 15px;
            color: #bdc3c7;
            background: #222;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        input[type=range] { width: 180px; cursor: pointer; }
    </style>
</head>
<body>

    <h2>‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ‡§∏‡•ç‡§™‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§Æ (VIBGYOR)</h2>

    <div class="controls">
        <label>‡§ï‡•ã‡§£ ‡§¨‡§¶‡§≤‡•á‡§Ç: <span id="angleVal" style="color:#f1c40f">45¬∞</span></label>
        <input type="range" id="sliderAngle" min="30" max="80" value="45" step="1">
    </div>

    <div id="canvas-container"></div>

    <div class="instructions">
        üí° <strong>‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡•á ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç</strong> ‡§î‡§∞ ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§π‡§ø‡§≤‡§æ‡§ï‡§∞ ‡§ú‡§æ‡§¶‡•Ç ‡§¶‡•á‡§ñ‡•á‡§Ç!
    </div>

    <script>
        let isLightOn = false;
        let prismSize = 140; // ‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ‡§•‡•ã‡§°‡§º‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§§‡§æ‡§ï‡§ø ‡§∏‡§¨ ‡§´‡§ø‡§ü ‡§π‡•ã
        let slider;
        
        // ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•à‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏
        let globalTorchX, globalTorchY;

        // VIBGYOR Colors (Top to Bottom: Red bends least, Violet bends most)
        const colors = [
            { code: 'R', name: 'Red', hex: '#FF0000', n: 1.20 },
            { code: 'O', name: 'Orange', hex: '#FF7F00', n: 1.24 },
            { code: 'Y', name: 'Yellow', hex: '#FFFF00', n: 1.28 },
            { code: 'G', name: 'Green', hex: '#00FF00', n: 1.32 },
            { code: 'B', name: 'Blue', hex: '#0000FF', n: 1.36 },
            { code: 'I', name: 'Indigo', hex: '#4B0082', n: 1.40 },
            { code: 'V', name: 'Violet', hex: '#9400D3', n: 1.44 }
        ];

        function setup() {
            // ‡§ï‡•à‡§®‡§µ‡§∏ ‡§ï‡§æ ‡§∏‡§æ‡§á‡§ú ‡§¨‡§¢‡§º‡§æ‡§Ø‡§æ ‡§§‡§æ‡§ï‡§ø ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡§ü‡•á ‡§®‡§π‡•Ä‡§Ç
            let canvas = createCanvas(800, 500);
            canvas.parent('canvas-container');
            angleMode(DEGREES);
            slider = select('#sliderAngle');
        }

        function draw() {
            background(25);
            
            // --- ‡§ï‡•à‡§®‡§µ‡§∏ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó ---
            // ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§ï‡•ã ‡§•‡•ã‡§°‡§º‡§æ ‡§ä‡§™‡§∞ ‡§î‡§∞ ‡§¶‡§æ‡§è‡§Å ‡§∂‡§ø‡§´‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§§‡§æ‡§ï‡§ø ‡§®‡•Ä‡§ö‡•á ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§ó‡§π ‡§¨‡§ö‡•á
            let transX = width / 2;
            let transY = height / 2 - 20;
            
            let i_deg = parseFloat(slider.value());
            document.getElementById('angleVal').innerText = i_deg + "¬∞";

            // --- 1. ‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ---
            let x1 = 0, y1 = -prismSize * 1.5;
            let x2 = -prismSize, y2 = 0;
            let x3 = prismSize, y3 = 0;
            
            let entryX = (x1 + x2) / 2;
            let entryY = (y1 + y2) / 2;

            // --- 2. ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡•Ä ‡§™‡•ã‡§ú‡•Ä‡§∂‡§® (‡§§‡§æ‡§ï‡§ø ‡§µ‡§π ‡§ï‡•à‡§®‡§µ‡§∏ ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§® ‡§ú‡§æ‡§è) ---
            // ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä (Ray Length) ‡§ï‡•ã ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡§æ
            let rayLen = 220; 
            
            // ‡§ï‡•ã‡§£ ‡§ï‡§æ ‡§≤‡•â‡§ú‡§ø‡§ï (‡§®‡•Ä‡§ö‡•á-‡§¨‡§æ‡§è‡§Ç ‡§∏‡•á ‡§ä‡§™‡§∞-‡§¶‡§æ‡§è‡§Ç)
            let posAngle = 180 - (i_deg - 15); 
            
            let srcX = entryX + rayLen * cos(posAngle);
            let srcY = entryY + rayLen * sin(posAngle);

            // ‡§ü‡•â‡§∞‡•ç‡§ö ‡§ï‡§ø‡§∏ ‡§§‡§∞‡§´ ‡§¶‡•á‡§ñ‡•á‡§ó‡•Ä (Auto-Aim)
            let pointingAngle = atan2(entryY - srcY, entryX - srcX);

            // ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§°‡§ø‡§ü‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è
            globalTorchX = transX + srcX;
            globalTorchY = transY + srcY;

            // ‡§ï‡§∞‡•ç‡§∏‡§∞ ‡§π‡•à‡§Ç‡§°
            if (dist(mouseX, mouseY, globalTorchX, globalTorchY) < 60) {
                cursor(HAND);
            } else {
                cursor(ARROW);
            }

            // --- ‡§°‡•ç‡§∞‡§æ‡§á‡§Ç‡§ó ‡§∂‡•Å‡§∞‡•Ç ---
            push();
            translate(transX, transY);

            // ‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ‡§¨‡•â‡§°‡•Ä
            stroke(255, 255, 255, 60); strokeWeight(2);
            fill(255, 255, 255, 10);
            triangle(x1, y1, x2, y2, x3, y3);
            noStroke(); fill(150); textSize(12);
            text("Prism", -20, 20);

            // --- 3. ‡§ü‡•â‡§∞‡•ç‡§ö ---
            push();
            translate(srcX, srcY);
            rotate(pointingAngle);

            // ‡§ü‡•â‡§∞‡•ç‡§ö ‡§¨‡•â‡§°‡•Ä
            fill(60); stroke(100); strokeWeight(1);
            rect(-85, -18, 70, 36, 6); // Handle
            fill(80);
            quad(-15, -18, 0, -26, 0, 26, -15, 18); // Head

            // ‡§¨‡§ü‡§® (Switch)
            if(isLightOn) fill(46, 204, 113); // Green
            else fill(231, 76, 60); // Red
            stroke(255); strokeWeight(1);
            ellipse(-50, 0, 16, 16);

            // ‡§≤‡•á‡§Ç‡§∏/‡§¨‡§≤‡•ç‡§¨
            if (isLightOn) {
                fill(255, 255, 200);
                drawingContext.shadowBlur = 25; drawingContext.shadowColor = "rgba(255, 255, 0, 0.8)";
            } else {
                fill(40);
                drawingContext.shadowBlur = 0;
            }
            ellipse(0, 0, 10, 48);
            drawingContext.shadowBlur = 0;

            // "Click" ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü
            if(!isLightOn) {
                rotate(-pointingAngle);
                fill(255); noStroke(); textSize(14); textAlign(CENTER);
                text("Click Switch!", -50, -40);
            }
            pop();

            // --- 4. ‡§ï‡§ø‡§∞‡§£‡•á‡§Ç ‡§î‡§∞ VIBGYOR ---
            if (isLightOn) {
                // White Ray
                stroke(255); strokeWeight(3);
                line(srcX, srcY, entryX, entryY);

                // ‡§∏‡•ç‡§™‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§Æ
                colors.forEach(col => {
                    stroke(col.hex); strokeWeight(2);

                    // ‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞
                    let spreadInside = (col.n - 1.0) * 90; 
                    let exitX = x3 - 20; 
                    let exitY = entryY + 40 + spreadInside;
                    line(entryX, entryY, exitX, exitY);

                    // ‡§™‡•ç‡§∞‡§ø‡§ú‡•ç‡§Æ ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ (Screen ki taraf)
                    let exitAngle = 15 + (col.n * 22);
                    let finalX = exitX + 220; // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä
                    let finalY = exitY + exitAngle;
                    line(exitX, exitY, finalX, finalY);

                    // --- VIBGYOR LABELS ---
                    noStroke(); fill(col.hex);
                    // Dot
                    ellipse(finalX, finalY, 8, 8);
                    
                    // Text (R, O, Y...)
                    textSize(16); textStyle(BOLD);
                    text(col.code, finalX + 15, finalY + 5);
                });
                
                // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§≤‡§æ‡§á‡§®
                stroke(150); strokeWeight(4);
                line(width/2 + 80, -200, width/2 + 80, 300);
                
                noStroke(); fill(200); textSize(14); 
                text("Screen", width/2 + 60, -210);
            }

            pop(); // ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§≤‡•á‡§∂‡§® ‡§¨‡§Ç‡§¶
        }

        // ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
        function mousePressed() {
            let d = dist(mouseX, mouseY, globalTorchX, globalTorchY);
            if (d < 65) {
                isLightOn = !isLightOn;
            }
        }
    </script>
</body>
</html>