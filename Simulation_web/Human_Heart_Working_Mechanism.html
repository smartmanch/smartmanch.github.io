<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realistic Heart Circulation Simulation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1d;
            color: #ecf0f1;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
        }

        h2 {
            color: #ff6b6b;
            text-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
            margin-bottom: 5px;
            text-align: center;
        }

        .subtitle { color: #95a5a6; margin-bottom: 15px; font-size: 14px; }

        .container {
            position: relative;
            background: #2f3640;
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.6);
            border: 3px solid #353b48;
        }

        canvas {
            background: radial-gradient(circle at center, #353b48 0%, #2f3640 100%);
            border-radius: 15px;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
        }

        /* ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§™‡•à‡§®‡§≤ */
        .controls {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
        }

        input[type=range] {
            width: 150px;
            cursor: pointer;
        }

        .legend {
            font-size: 12px;
            color: #dcdde1;
        }
        .dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 5px; }

        .footer-info {
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
            color: #7f8c8d;
        }
        .cc-badge { background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; font-weight: bold; margin-right: 5px;}

    </style>
</head>
<body>

    <h2>‡§Æ‡§æ‡§®‡§µ ‡§™‡§∞‡§ø‡§∏‡§Ç‡§ö‡§∞‡§£ ‡§§‡§Ç‡§§‡•ç‡§∞ (Human Circulatory System)</h2>
    <div class="subtitle">‡§´‡•á‡§´‡§°‡§º‡•á ‚ÜîÔ∏è ‡§π‡•É‡§¶‡§Ø ‚ÜîÔ∏è ‡§∂‡§∞‡•Ä‡§∞</div>

    <div class="container">
        <canvas id="simCanvas" width="600" height="650"></canvas>
        
        <div class="controls">
            <div>
                <label>üíì ‡§ß‡§°‡§º‡§ï‡§® (Heart Rate): </label>
                <input type="range" id="rateSlider" min="0.5" max="2.5" step="0.1" value="1">
            </div>
            <div class="legend">
                <div><span class="dot" style="background:#3498db;"></span> ‡§Ö‡§∂‡•Å‡§¶‡•ç‡§ß ‡§∞‡§ï‡•ç‡§§ (CO‚ÇÇ)</div>
                <div><span class="dot" style="background:#e74c3c;"></span> ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§∞‡§ï‡•ç‡§§ (O‚ÇÇ)</div>
            </div>
        </div>
    </div>

    <div class="footer-info">
        <span class="cc-badge">CC</span> <span style="color:#0be881; font-weight:bold;">@Rohitash Bharia</span>
        <p>‡§∞‡§ï‡•ç‡§§ ‡§ï‡§æ ‡§¶‡•ã‡§π‡§∞‡§æ ‡§™‡§∞‡§ø‡§∏‡§Ç‡§ö‡§∞‡§£ (Double Circulation)</p>
    </div>

<script>
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');
    const slider = document.getElementById('rateSlider');

    // ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§¨‡§ø‡§Ç‡§¶‡•Å
    const cx = canvas.width / 2;
    const cy = canvas.height / 2;

    // ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§® ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏
    let time = 0;
    let pulse = 0; // ‡§ß‡§°‡§º‡§ï‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ (0 ‡§∏‡•á 1)
    
    // ‡§ï‡§£ (Blood Cells)
    const particles = [];
    const numParticles = 120;

    // ‡§∞‡§æ‡§∏‡•ç‡§§‡•á (Paths) ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§¨‡§ø‡§Ç‡§¶‡•Å
    // Lungs (Top), Body (Bottom), Heart (Center)
    const lungL = {x: cx - 100, y: 80}; 
    const lungR = {x: cx + 100, y: 80};
    const bodyArea = {x: cx, y: 580};
    
    // Heart Chambers Coordinates (Approx)
    const RA = {x: cx - 50, y: cy - 40}; // Right Atrium
    const RV = {x: cx - 40, y: cy + 50}; // Right Ventricle
    const LA = {x: cx + 50, y: cy - 40}; // Left Atrium
    const LV = {x: cx + 40, y: cy + 50}; // Left Ventricle

    // --- ‡§ï‡§£ (Particles) ‡§∏‡•á‡§ü‡§Ö‡§™ ---
    class BloodParticle {
        constructor(circuit) {
            this.circuit = circuit; // 'pulmonary' (Lungs) or 'systemic' (Body)
            this.progress = Math.random();
            this.speed = 0.002 + Math.random() * 0.002;
            this.offset = (Math.random() - 0.5) * 15; // ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è
        }

        update(rate) {
            // ‡§ß‡§°‡§º‡§ï‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ó‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§â‡§õ‡§æ‡§≤ (Surge)
            let surge = 1 + (pulse * 2); 
            this.progress += this.speed * rate * surge;
            
            if(this.progress >= 1) {
                this.progress = 0;
                // ‡§ú‡§¨ ‡§∏‡§æ‡§á‡§ï‡§ø‡§≤ ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•ã, ‡§§‡•ã ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§¶‡§≤‡•á‡§Ç (Body -> Lungs -> Body)
                this.circuit = (this.circuit === 'pulmonary') ? 'systemic' : 'pulmonary';
            }
        }

        getPosition() {
            // ‡§µ‡•á‡§™‡•â‡§á‡§Ç‡§ü‡•ç‡§∏ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§á‡§Ç‡§ü‡§∞‡§™‡•ã‡§≤‡•á‡§∂‡§® (Interpolation Logic)
            let x, y, color;

            if (this.circuit === 'systemic') {
                // RED BLOOD: Lungs -> LA -> LV -> Body
                // BLUE BLOOD: Body -> RA -> RV -> Lungs (Start of Pulmonary)
                
                // ‡§π‡§Æ ‡§á‡§∏‡•á ‡§¶‡•ã ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§§‡•ã‡§°‡§º‡§§‡•á ‡§π‡•à‡§Ç ‡§µ‡§ø‡§ú‡•Å‡§Ö‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è:
                // Part 1: Oxygenated (Red) Lungs -> Body
                // Part 2: Deoxygenated (Blue) Body -> Lungs (Next circuit)
                
                // ‡§Ø‡§π‡§æ‡§Å ‡§π‡§Æ "Systemic Loop" (‡§∂‡•Å‡§¶‡•ç‡§ß ‡§∞‡§ï‡•ç‡§§ ‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•ã) ‡§¶‡§ø‡§ñ‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
                // Path: Lungs(Top) -> LA -> LV -> Body(Bottom)
                
                if (this.progress < 0.2) { // Lungs to LA
                     x = interp(lungL.x, RA.x + 100, this.progress/0.2); // Trick to cross to LA
                     y = interp(lungL.y, LA.y, this.progress/0.2);
                     color = '#e74c3c'; // Red
                } else if (this.progress < 0.4) { // LA to LV
                     x = interp(LA.x, LV.x, (this.progress-0.2)/0.2);
                     y = interp(LA.y, LV.y, (this.progress-0.2)/0.2);
                     color = '#e74c3c';
                } else if (this.progress < 0.9) { // LV to Body
                     x = interp(LV.x, bodyArea.x, (this.progress-0.4)/0.5);
                     y = interp(LV.y, bodyArea.y, (this.progress-0.4)/0.5);
                     color = '#e74c3c';
                } else { // At Body (Turning Blue)
                     x = bodyArea.x;
                     y = bodyArea.y;
                     color = '#9b59b6'; // Purple transition
                }

            } else {
                // Pulmonary Loop (‡§Ö‡§∂‡•Å‡§¶‡•ç‡§ß ‡§∞‡§ï‡•ç‡§§ ‡§´‡•á‡§´‡§°‡§º‡•ã‡§Ç ‡§ï‡•ã)
                // Path: Body(Bottom) -> RA -> RV -> Lungs(Top)
                
                if (this.progress < 0.3) { // Body to RA
                     x = interp(bodyArea.x, RA.x, this.progress/0.3);
                     y = interp(bodyArea.y, RA.y, this.progress/0.3);
                     color = '#3498db'; // Blue
                } else if (this.progress < 0.5) { // RA to RV
                     x = interp(RA.x, RV.x, (this.progress-0.3)/0.2);
                     y = interp(RA.y, RV.y, (this.progress-0.3)/0.2);
                     color = '#3498db';
                } else if (this.progress < 1.0) { // RV to Lungs
                     x = interp(RV.x, lungR.x - 20, (this.progress-0.5)/0.5); // Cross to Lungs
                     y = interp(RV.y, lungR.y, (this.progress-0.5)/0.5);
                     color = '#3498db';
                }
            }

            // Curve correction (‡§•‡•ã‡§°‡§º‡§æ ‡§µ‡§ï‡•ç‡§∞ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)
            // ‡§¶‡§ø‡§≤ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§∏‡§ï‡§∞‡•á, ‡§¨‡§æ‡§π‡§∞ ‡§ö‡•å‡§°‡§º‡•á
            let widthMod = 1;
            if (y > cy - 50 && y < cy + 50) widthMod = 0.2; // ‡§¶‡§ø‡§≤ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡§ï‡§∞‡•á
            
            return {
                x: x + this.offset * widthMod, 
                y: y, 
                color: color || '#fff'
            };
        }
    }

    function interp(start, end, amt) {
        return start + (end - start) * amt;
    }

    // ‡§ï‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç
    for(let i=0; i<numParticles; i++) {
        particles.push(new BloodParticle(i % 2 === 0 ? 'systemic' : 'pulmonary'));
    }


    // --- ‡§°‡•ç‡§∞‡§æ‡§á‡§Ç‡§ó ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®‡•ç‡§∏ ---

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        const rate = parseFloat(slider.value);
        time += 0.05 * rate;
        
        // ‡§ß‡§°‡§º‡§ï‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ (Systole/Diastole)
        pulse = Math.pow((Math.sin(time) + 1) / 2, 4); // Sharp beat
        const scale = 1 + (pulse * 0.05); // 5% expansion

        // 1. ‡§§‡§æ‡§∞/‡§®‡§∏‡•ã‡§Ç ‡§ï‡§æ ‡§ú‡§æ‡§≤ (Background Pipes)
        drawVessels();

        // 2. ‡§´‡•á‡§´‡§°‡§º‡•á (Lungs) - Top
        drawLungs();

        // 3. ‡§∂‡§∞‡•Ä‡§∞ (Body) - Bottom
        drawBodyTissue();

        // 4. ‡§¶‡§ø‡§≤ (Heart) - Center (Beating)
        ctx.save();
        ctx.translate(cx, cy);
        ctx.scale(scale, scale);
        ctx.translate(-cx, -cy);
        drawRealisticHeart();
        ctx.restore();

        // 5. ‡§ï‡§£ (Blood Cells)
        particles.forEach(p => {
            p.update(rate);
            const pos = p.getPosition();
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, 4, 0, Math.PI*2);
            ctx.fillStyle = pos.color;
            ctx.fill();
        });
        
        // 6. ‡§≤‡•á‡§¨‡§≤‡•ç‡§∏
        drawLabels();

        requestAnimationFrame(draw);
    }

    function drawLungs() {
        // ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§î‡§∞ ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§´‡•á‡§´‡§°‡§º‡§æ
        ctx.fillStyle = "#ffcccc"; // Pinkish
        ctx.strokeStyle = "#e0a8a8";
        ctx.lineWidth = 2;

        // Left Lung
        ctx.beginPath();
        ctx.ellipse(lungL.x, lungL.y, 60, 40, 0, 0, Math.PI*2);
        ctx.fill(); ctx.stroke();
        
        // Right Lung
        ctx.beginPath();
        ctx.ellipse(lungR.x, lungR.y, 60, 40, 0, 0, Math.PI*2);
        ctx.fill(); ctx.stroke();
        
        // Text
        ctx.fillStyle = "#c0392b";
        ctx.font = "bold 16px Arial";
        ctx.textAlign = "center";
        ctx.fillText("‡§´‡•á‡§´‡§°‡§º‡•á (Lungs)", cx, 85);
    }

    function drawBodyTissue() {
        // ‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•á ‡§ä‡§§‡§ï (Capillaries network visualization)
        ctx.fillStyle = "#e58e26";
        ctx.strokeStyle = "#b33939";
        
        ctx.beginPath();
        ctx.roundRect(cx - 100, 550, 200, 60, 10);
        ctx.fill();
        ctx.stroke();

        ctx.fillStyle = "#fff";
        ctx.font = "bold 16px Arial";
        ctx.fillText("‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•á ‡§Ö‡§Ç‡§ó (Body Organs)", cx, 585);
    }

    function drawVessels() {
        ctx.lineWidth = 15;
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        
        // Veins (Blue) - Body to Heart
        ctx.strokeStyle = "rgba(52, 152, 219, 0.3)";
        ctx.beginPath();
        ctx.moveTo(cx, 550); // From Body
        ctx.quadraticCurveTo(cx - 150, 400, RA.x, RA.y); // To RA
        ctx.stroke();

        // Pulmonary Artery (Blue) - Heart to Lungs
        ctx.beginPath();
        ctx.moveTo(RV.x, RV.y);
        ctx.quadraticCurveTo(cx - 100, cy - 100, lungR.x, lungR.y + 20); // To Lungs
        ctx.stroke();

        // Pulmonary Vein (Red) - Lungs to Heart
        ctx.strokeStyle = "rgba(231, 76, 60, 0.3)";
        ctx.beginPath();
        ctx.moveTo(lungL.x, lungL.y + 20);
        ctx.quadraticCurveTo(cx + 100, cy - 100, LA.x, LA.y); // To LA
        ctx.stroke();

        // Aorta (Red) - Heart to Body
        ctx.beginPath();
        ctx.moveTo(LV.x, LV.y);
        ctx.quadraticCurveTo(cx + 150, 400, cx, 550); // To Body
        ctx.stroke();
    }

    function drawRealisticHeart() {
        // ‡§¶‡§ø‡§≤ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (Custom Shape)
        ctx.strokeStyle = "#eec0c0";
        ctx.lineWidth = 3;
        ctx.fillStyle = "#c0392b"; // Muscle Color

        // ‡§™‡•Ç‡§∞‡§æ ‡§¶‡§ø‡§≤ (Outline)
        ctx.beginPath();
        // Top Left Curve
        ctx.moveTo(cx, cy - 60);
        ctx.bezierCurveTo(cx - 70, cy - 90, cx - 110, cy - 20, cx - 110, cy + 30);
        // Bottom Point (Apex)
        ctx.bezierCurveTo(cx - 100, cy + 110, cx - 20, cy + 130, cx, cy + 140);
        // Right Side up
        ctx.bezierCurveTo(cx + 20, cy + 130, cx + 100, cy + 110, cx + 110, cy + 30);
        // Top Right Curve
        ctx.bezierCurveTo(cx + 110, cy - 20, cx + 70, cy - 90, cx, cy - 60);
        ctx.fill();
        ctx.stroke();

        // ‡§∏‡•á‡§™‡•ç‡§ü‡§Æ (Septum - ‡§¨‡•Ä‡§ö ‡§ï‡•Ä ‡§¶‡•Ä‡§µ‡§æ‡§∞)
        ctx.beginPath();
        ctx.moveTo(cx, cy - 60);
        ctx.lineTo(cx, cy + 110);
        ctx.strokeStyle = "#a93226";
        ctx.lineWidth = 5;
        ctx.stroke();

        // ‡§ï‡§ï‡•ç‡§∑‡•ã‡§Ç ‡§ï‡•ã ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§≤‡•ç‡§ï‡§æ ‡§∞‡§Ç‡§ó (Chambers)
        ctx.fillStyle = "rgba(0,0,0,0.3)";
        
        // RA
        ctx.beginPath(); ctx.arc(RA.x, RA.y, 25, 0, Math.PI*2); ctx.fill();
        // LA
        ctx.beginPath(); ctx.arc(LA.x, LA.y, 25, 0, Math.PI*2); ctx.fill();
        
        // Ventricles (‡§•‡•ã‡§°‡§º‡•á V ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•á)
        // RV
        ctx.beginPath(); 
        ctx.moveTo(cx - 10, cy + 10); ctx.lineTo(cx - 80, cy + 20); ctx.lineTo(cx - 20, cy + 100); ctx.fill();
        // LV (‡§¨‡§°‡§º‡§æ)
        ctx.beginPath(); 
        ctx.moveTo(cx + 10, cy + 10); ctx.lineTo(cx + 80, cy + 20); ctx.lineTo(cx + 20, cy + 110); ctx.fill();

        // ‡§µ‡§æ‡§≤‡•ç‡§µ (Valves) - ‡§ß‡§°‡§º‡§ï‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡•Å‡§≤‡§§‡•á/‡§¨‡§Ç‡§¶ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 3;
        const valveOpen = pulse * 10;
        
        // Right Valve (Tricuspid)
        ctx.beginPath();
        ctx.moveTo(RA.x - 15, RA.y + 25);
        ctx.lineTo(RA.x + 15, RA.y + 25);
        ctx.moveTo(cx - 50, cy); ctx.lineTo(cx - 50, cy + 15 + valveOpen); // Flap
        ctx.stroke();

        // Left Valve (Mitral)
        ctx.beginPath();
        ctx.moveTo(LA.x - 15, LA.y + 25);
        ctx.lineTo(LA.x + 15, LA.y + 25);
        ctx.moveTo(cx + 50, cy); ctx.lineTo(cx + 50, cy + 15 + valveOpen); // Flap
        ctx.stroke();
    }

    function drawLabels() {
        ctx.fillStyle = "white";
        ctx.font = "bold 12px Arial";
        ctx.textAlign = "center";
        
        // Chambers
        ctx.fillText("RA", RA.x, RA.y + 5);
        ctx.fillText("LA", LA.x, LA.y + 5);
        ctx.fillText("RV", RV.x, RV.y + 40);
        ctx.fillText("LV", LV.x, LV.y + 40);

        // Titles
        ctx.font = "bold 14px Arial";
        ctx.fillStyle = "#3498db";
        ctx.fillText("‡§Æ‡§π‡§æ‡§∂‡§ø‡§∞‡§æ", cx - 130, cy);
        ctx.fillStyle = "#e74c3c";
        ctx.fillText("‡§Æ‡§π‡§æ‡§ß‡§Æ‡§®‡•Ä", cx + 130, cy);
    }

    draw();

</script>
</body>
</html>